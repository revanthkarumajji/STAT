{
  "hash": "0c3a4ae1962d69c87303cfb8999ef5c9",
  "result": {
    "markdown": "---\ntitle: \"Mid Project\"\nauthor: \"Revanth Karumajji\"\ndate: \"2024-03-11\"\noutput:\n  pdf_document: default\n  word_document: default\n---\n\n\n\n\n## R Markdown\n\nThis is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.\n\nWhen you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\n# Create example data\ndata <- data.frame(\n  Category = c(\"2017-2018\", \"2018-2019\"),\n  Total = c(1780.8, 1703.8),\n  Government_Funding = c(1213.7, 1207.7),\n  Revenue = c(490.1, 573.1),\n  Financing_and_other_income = c(116.9, 127.6),\n  Subscription_fee = c(124.4, 127.2),\n  Advertising = c(248.8, 275.7),\n  Digital = c(31.0, 42.6),\n  Television = c(217.8, 275.7)\n)\n\n# Reshape the data\ndata_long <- tidyr::pivot_longer(data, cols = c(Government_Funding,Financing_and_other_income, Subscription_fee,Digital, Television), names_to = \"Subcategory\", values_to = \"Value\")\n\n# Plot\nggplot(data_long, aes(x = Category, y = Value, fill = Subcategory)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  coord_flip() +  # Flip the coordinates for horizontal bars\n  geom_bar(data = data, aes(x = Category, y = Total), stat = \"identity\", fill = \"transparent\") +\n  theme_minimal()+\n  labs(y = \"Value (in millions)\", x = \"Year\")\n```\n\n::: {.cell-output-display}\n![](mid_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\n# Create example data\ndata <- data.frame(\n  Category = c(\"2017-2018\", \"2018-2019\"),\n  Total = c(1780.8, 1703.8),\n  Government_Funding = c(1213.7, 1207.7),\n  Revenue = c(490.1, 573.1),\n  Financing_and_other_income = c(116.9, 127.6),\n  Subscription_fee = c(124.4, 127.2),\n  Advertising = c(248.8, 275.7),\n  Digital = c(31.0, 42.6),\n  Television = c(217.8, 275.7)\n)\n\n# Reshape the data\ndata_long <- tidyr::pivot_longer(data, cols = c(Government_Funding, Financing_and_other_income, Subscription_fee, Digital, Television), names_to = \"Subcategory\", values_to = \"Value\")\n\n# Determine the order of stacking\nstacking_order <- c(\"Government_Funding\", \"Financing_and_other_income\", \"Subscription_fee\", \"Television\", \"Digital\")\n\n# Convert Subcategory to factor and set levels according to stacking order\ndata_long$Subcategory <- factor(data_long$Subcategory, levels = stacking_order)\n\n\n\n# Plot\nggplot(data_long, aes(x = Category, y = Value, fill = Subcategory)) +\n  geom_bar(stat = \"identity\", position = \"stack\") +\n  coord_flip() +  # Flip the coordinates for horizontal bars\n  geom_bar(data = data, aes(x = Category, y = Total), stat = \"identity\", fill = \"transparent\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](mid_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(plotly)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'plotly' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'plotly'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:ggplot2':\n\n    last_plot\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:graphics':\n\n    layout\n```\n:::\n\n```{.r .cell-code}\n# Create example data\ndata <- data.frame(\n  Category = c(\"2017-2018\", \"2018-2019\"),\n  Total = c(1780.8, 1703.8),\n  Government_Funding = c(1213.7, 1207.7),\n  Revenue = c(490.1, 573.1),\n  Financing_and_other_income = c(116.9, 127.6),\n  Subscription_fee = c(124.4, 127.2),\n  Advertising = c(248.8, 275.7),\n  Digital = c(31.0, 42.6),\n  Television = c(217.8, 275.7)\n)\n\n# Reshape the data\ndata_long <- tidyr::pivot_longer(data, cols = c(Government_Funding, Financing_and_other_income, Subscription_fee, Digital, Television), names_to = \"Subcategory\", values_to = \"Value\")\n\n# Determine the order of stacking\nstacking_order <- c(\"Government_Funding\", \"Financing_and_other_income\", \"Subscription_fee\", \"Television\", \"Digital\")\n\n# Convert Subcategory to factor and set levels according to stacking order\ndata_long$Subcategory <- factor(data_long$Subcategory, levels = stacking_order)\n\n# Function to create the plot\ncreate_plot <- function(data, selected_option, selected_year) {\n  p <- ggplot(data, aes(x = Category, y = Value, fill = Subcategory)) +\n    geom_bar(stat = \"identity\", position = \"stack\") +\n    coord_flip() +\n    theme_minimal() +\n    labs(title = selected_option)\n  \n  return(p)\n}\n\n# Create interactive plot\nplotly_plot <- ggplotly(create_plot(data_long, \"Total\"), dynamicTicks = TRUE) %>%\n  layout(\n    updatemenus = list(\n      list(\n        buttons = list(\n          list(method = \"update\", args = list(list(visible = list(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE))), label = \"Total\"),\n          list(method = \"update\", args = list(list(visible = list(TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE))), label = \"Government Funding\"),\n          list(method = \"update\", args = list(list(visible = list(FALSE,TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE))), label = \"Revenue\"),\n          list(method = \"update\", args = list(list(visible = list(FALSE,FALSE, FALSE, TRUE, TRUE, TRUE, TRUE, TRUE))), label = \"Advertising\")\n        ),\n        x = 0.1,\n        xanchor = \"left\",\n        y = 1.15,\n        yanchor = \"top\",\n        font = list(size = 12)\n      ),\n      list(\n        buttons = list(\n          list(method = \"update\", args = list(list(visible = list(TRUE, TRUE))), label = \"\"),\n          list(method = \"update\", args = list(list(visible = list(TRUE, TRUE))), label = \"\")\n        ),\n        x = 0.3,\n        xanchor = \"left\",\n        y = 1.15,\n        yanchor = \"top\",\n        font = list(size = 12)\n      )\n    )\n  )\n\nplotly_plot\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-c0c2d3ed6b00759b081e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c0c2d3ed6b00759b081e\">{\"x\":{\"data\":[{\"orientation\":\"h\",\"width\":[0.89999999999999991,0.90000000000000013],\"base\":[490.10000000000002,573.10000000000002],\"x\":[1213.7000000000003,1207.6999999999998],\"y\":[\"2017-2018\",\"2018-2019\"],\"text\":[\"Category: 2017-2018<br />Value: 1213.7<br />Subcategory: Government_Funding\",\"Category: 2018-2019<br />Value: 1207.7<br />Subcategory: Government_Funding\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Government_Funding\",\"legendgroup\":\"Government_Funding\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"h\",\"width\":[0.89999999999999991,0.90000000000000013],\"base\":[373.20000000000005,445.5],\"x\":[116.89999999999998,127.60000000000002],\"y\":[\"2017-2018\",\"2018-2019\"],\"text\":[\"Category: 2017-2018<br />Value:  116.9<br />Subcategory: Financing_and_other_income\",\"Category: 2018-2019<br />Value:  127.6<br />Subcategory: Financing_and_other_income\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(163,165,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Financing_and_other_income\",\"legendgroup\":\"Financing_and_other_income\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"h\",\"width\":[0.89999999999999991,0.90000000000000013],\"base\":[248.80000000000001,318.30000000000001],\"x\":[124.40000000000003,127.19999999999999],\"y\":[\"2017-2018\",\"2018-2019\"],\"text\":[\"Category: 2017-2018<br />Value:  124.4<br />Subcategory: Subscription_fee\",\"Category: 2018-2019<br />Value:  127.2<br />Subcategory: Subscription_fee\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,125,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Subscription_fee\",\"legendgroup\":\"Subscription_fee\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"h\",\"width\":[0.89999999999999991,0.90000000000000013],\"base\":[31,42.600000000000001],\"x\":[217.80000000000001,275.69999999999999],\"y\":[\"2017-2018\",\"2018-2019\"],\"text\":[\"Category: 2017-2018<br />Value:  217.8<br />Subcategory: Television\",\"Category: 2018-2019<br />Value:  275.7<br />Subcategory: Television\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,176,246,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Television\",\"legendgroup\":\"Television\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"h\",\"width\":[0.89999999999999991,0.90000000000000013],\"base\":[0,0],\"x\":[31,42.600000000000001],\"y\":[\"2017-2018\",\"2018-2019\"],\"text\":[\"Category: 2017-2018<br />Value:   31.0<br />Subcategory: Digital\",\"Category: 2018-2019<br />Value:   42.6<br />Subcategory: Digital\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(231,107,243,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Digital\",\"legendgroup\":\"Digital\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":78.173515981735179},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Total\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":true,\"range\":[-89.040000000000006,1869.8399999999999],\"tickmode\":\"auto\",\"ticktext\":[\"0\",\"500\",\"1000\",\"1500\"],\"tickvals\":[0,499.99999999999994,1000,1500],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"500\",\"1000\",\"1500\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Value\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"category\",\"autorange\":true,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"auto\",\"ticktext\":[\"2017-2018\",\"2018-2019\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"2017-2018\",\"2018-2019\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Subcategory\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"updatemenus\":[{\"buttons\":[{\"method\":\"update\",\"args\":[{\"visible\":[true,true,true,true,true,true,true,true]}],\"label\":\"Total\"},{\"method\":\"update\",\"args\":[{\"visible\":[true,false,false,false,false,false,false,false]}],\"label\":\"Government Funding\"},{\"method\":\"update\",\"args\":[{\"visible\":[false,true,true,true,true,true,true,true]}],\"label\":\"Revenue\"},{\"method\":\"update\",\"args\":[{\"visible\":[false,false,false,true,true,true,true,true]}],\"label\":\"Advertising\"}],\"x\":0.10000000000000001,\"xanchor\":\"left\",\"y\":1.1499999999999999,\"yanchor\":\"top\",\"font\":{\"size\":12}},{\"buttons\":[{\"method\":\"update\",\"args\":[{\"visible\":[true,true]}],\"label\":\"\"},{\"method\":\"update\",\"args\":[{\"visible\":[true,true]}],\"label\":\"\"}],\"x\":0.29999999999999999,\"xanchor\":\"left\",\"y\":1.1499999999999999,\"yanchor\":\"top\",\"font\":{\"size\":12}}]},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"4df46fbe1a89\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"4df46fbe1a89\",\"visdat\":{\"4df46fbe1a89\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(plotly)\n\n# Sample data\ndf <- data.frame(\n  Year = c(\"2018-2019\", \"2017-2018\"),\n  `Government Funding` = c(1213.7, 1207.7),\n  `Financing_and_other_income` = c(116.9, 127.6),\n  `Subscription_fee` = c(124.4, 127.2),\n  `Digital` = c(31.0, 42.6),\n  `Television` = c(217.8, 275.7)\n)\n\n# Calculate total revenue for each year\ndf$Revenue <- rowSums(df[, c(\"Financing_and_other_income\", \"Subscription_fee\", \"Digital\", \"Television\")])\n\n# Reshape the data using pivot_longer\ndf_long <- df %>%\n  pivot_longer(cols = -Year, names_to = \"group\", values_to = \"value\") %>%\n  mutate(group = case_when(\n    group %in% c(\"Government Funding\", \"Revenue\") ~ \"Total\",\n    TRUE ~ group\n  ))\n\n# Create a ggplot object\np <- ggplot(df_long, aes(x = Year, y = value, fill = group)) +\n  geom_bar(stat = \"identity\", position = \"stack\", width = 0.7) +\n  \n  scale_y_continuous(labels = scales::comma_format()) +\n  labs(title = \"Funding and Revenue Comparison\",\n       y = \"Count (in millions)\",\n       x = \"Year\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")\n\n# Convert ggplot object to plotly\nplotly_plot <- ggplotly(p, tooltip = c(\"x\", \"y\")) \n\n# Show the interactive plot\nplotly_plot\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-2acecf64ba3f50dcd6be\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2acecf64ba3f50dcd6be\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.70000000000000018,0.70000000000000007],\"base\":[2162.9000000000001,2311.3000000000002],\"x\":[2,1],\"y\":[31,42.599999999999909],\"text\":[\"Year: 2018-2019<br />value:   31.0\",\"Year: 2017-2018<br />value:   42.6\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Digital\",\"legendgroup\":\"Digital\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000018,0.70000000000000007],\"base\":[2046,2183.7000000000003],\"x\":[2,1],\"y\":[116.90000000000009,127.59999999999991],\"text\":[\"Year: 2018-2019<br />value:  116.9\",\"Year: 2017-2018<br />value:  127.6\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(183,159,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Financing_and_other_income\",\"legendgroup\":\"Financing_and_other_income\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000018,0.70000000000000007],\"base\":[832.30000000000007,976],\"x\":[2,1],\"y\":[1213.6999999999998,1207.7000000000003],\"text\":[\"Year: 2018-2019<br />value: 1213.7\",\"Year: 2017-2018<br />value: 1207.7\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Government.Funding\",\"legendgroup\":\"Government.Funding\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000018,0.70000000000000007],\"base\":[707.90000000000009,848.79999999999995],\"x\":[2,1],\"y\":[124.39999999999998,127.20000000000005],\"text\":[\"Year: 2018-2019<br />value:  124.4\",\"Year: 2017-2018<br />value:  127.2\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Subscription_fee\",\"legendgroup\":\"Subscription_fee\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000018,0.70000000000000007],\"base\":[490.10000000000002,573.10000000000002],\"x\":[2,1],\"y\":[217.80000000000007,275.69999999999993],\"text\":[\"Year: 2018-2019<br />value:  217.8\",\"Year: 2017-2018<br />value:  275.7\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Television\",\"legendgroup\":\"Television\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.70000000000000018,0.70000000000000007],\"base\":[0,0],\"x\":[2,1],\"y\":[490.10000000000002,573.10000000000002],\"text\":[\"Year: 2018-2019<br />value:  490.1\",\"Year: 2017-2018<br />value:  573.1\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(245,100,227,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"Total\",\"legendgroup\":\"Total\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":40.182648401826491,\"l\":54.794520547945211},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Funding and Revenue Comparison\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,2.6000000000000001],\"tickmode\":\"array\",\"ticktext\":[\"2017-2018\",\"2018-2019\"],\"tickvals\":[1,2],\"categoryorder\":\"array\",\"categoryarray\":[\"2017-2018\",\"2018-2019\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Year\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-117.69500000000001,2471.5950000000003],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"500\",\"1,000\",\"1,500\",\"2,000\"],\"tickvals\":[0,500.00000000000006,999.99999999999989,1500,2000.0000000000002],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"500\",\"1,000\",\"1,500\",\"2,000\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Count (in millions)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"group\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"4df470c65eda\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"4df470c65eda\",\"visdat\":{\"4df470c65eda\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plotly)\nlibrary(dplyr)\n\n# Sample data\ndf <- data.frame(\n  Year = c(\"2018-2019\", \"2017-2018\"),\n  `Government_Funding` = c(1213.7, 1207.7),\n  `Revenue` = c(490.1, 573.1),\n  `Financing_and_other_income` = c(116.9, 127.6),\n  `Subscriber_fee` = c(124.4, 127.2),\n  `Advertising` = c(248.8, 275.7),\n  `Digital` = c(31, 42.6),\n  `Television` = c(217.8, 275.7)\n)\n\n# Reshape the data\ndf_long <- df %>%\n  pivot_longer(cols = -Year, names_to = \"group\", values_to = \"value\") %>%\n  mutate(group = case_when(\n    group == \"Government_Funding\" ~ \"Government Funding\",\n    group == \"Revenue\" ~ \"Revenue\",\n    group == \"Financing_and_other_income\" ~ \"Financing and other income\",\n    group == \"Subscriber_fee\" ~ \"Subscriber fee\",\n    group == \"Advertising\" ~ \"Advertising\",\n    group == \"Digital\" ~ \"Digital\",\n    group == \"Television\" ~ \"Television\"\n  ))\n\n# Create interactive stacked bar chart\nplot <- plot_ly(df_long, x = ~Year, y = ~value, type = 'bar', color = ~group,\n                text = ~paste(\"Value: \", value),\n                hoverinfo = \"text\") %>%\n  layout(\n    title = \"Government Funding and Revenue Comparison\",\n    xaxis = list(title = \"Year\"),\n    yaxis = list(title = \"Count (in millions)\"),\n    barmode = 'stack',\n    showlegend = TRUE\n  )\n\n# Add dropdown selectors for transparency\nplot <- plot %>%\n  layout(\n    updatemenus = list(\n      list(\n        buttons = list(\n          list(args = list(\"opacity\", 1), label = \"Full opacity\", method = \"restyle\"),\n          list(args = list(\"opacity\", 0.7), label = \"70% opacity\", method = \"restyle\"),\n          list(args = list(\"opacity\", 0.5), label = \"50% opacity\", method = \"restyle\"),\n          list(args = list(\"opacity\", 0.3), label = \"30% opacity\", method = \"restyle\"),\n          list(args = list(\"opacity\", 0), label = \"No opacity\", method = \"restyle\")\n        ),\n        x = 0.9,\n        y = 1.2,\n        direction = \"down\",\n        showactive = TRUE\n      )\n    )\n  )\n\n# Show the plot\nplot\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-c58f70b9e2a7d51e51ef\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-c58f70b9e2a7d51e51ef\">{\"x\":{\"visdat\":{\"4df440021528\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4df440021528\",\"attrs\":{\"4df440021528\":{\"x\":{},\"y\":{},\"text\":{},\"hoverinfo\":\"text\",\"color\":{},\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"bar\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"Government Funding and Revenue Comparison\",\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Year\",\"type\":\"category\",\"categoryorder\":\"array\",\"categoryarray\":[\"2017-2018\",\"2018-2019\"]},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"Count (in millions)\"},\"barmode\":\"stack\",\"showlegend\":true,\"updatemenus\":[{\"buttons\":[{\"args\":[\"opacity\",1],\"label\":\"Full opacity\",\"method\":\"restyle\"},{\"args\":[\"opacity\",0.69999999999999996],\"label\":\"70% opacity\",\"method\":\"restyle\"},{\"args\":[\"opacity\",0.5],\"label\":\"50% opacity\",\"method\":\"restyle\"},{\"args\":[\"opacity\",0.29999999999999999],\"label\":\"30% opacity\",\"method\":\"restyle\"},{\"args\":[\"opacity\",0],\"label\":\"No opacity\",\"method\":\"restyle\"}],\"x\":0.90000000000000002,\"y\":1.2,\"direction\":\"down\",\"showactive\":true}],\"hovermode\":\"closest\"},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"x\":[\"2018-2019\",\"2017-2018\"],\"y\":[248.80000000000001,275.69999999999999],\"text\":[\"Value:  248.8\",\"Value:  275.7\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Advertising\",\"marker\":{\"color\":\"rgba(102,194,165,1)\",\"line\":{\"color\":\"rgba(102,194,165,1)\"}},\"textfont\":{\"color\":\"rgba(102,194,165,1)\"},\"error_y\":{\"color\":\"rgba(102,194,165,1)\"},\"error_x\":{\"color\":\"rgba(102,194,165,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2018-2019\",\"2017-2018\"],\"y\":[31,42.600000000000001],\"text\":[\"Value:  31\",\"Value:  42.6\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Digital\",\"marker\":{\"color\":\"rgba(252,141,98,1)\",\"line\":{\"color\":\"rgba(252,141,98,1)\"}},\"textfont\":{\"color\":\"rgba(252,141,98,1)\"},\"error_y\":{\"color\":\"rgba(252,141,98,1)\"},\"error_x\":{\"color\":\"rgba(252,141,98,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2018-2019\",\"2017-2018\"],\"y\":[116.90000000000001,127.59999999999999],\"text\":[\"Value:  116.9\",\"Value:  127.6\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Financing and other income\",\"marker\":{\"color\":\"rgba(141,160,203,1)\",\"line\":{\"color\":\"rgba(141,160,203,1)\"}},\"textfont\":{\"color\":\"rgba(141,160,203,1)\"},\"error_y\":{\"color\":\"rgba(141,160,203,1)\"},\"error_x\":{\"color\":\"rgba(141,160,203,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2018-2019\",\"2017-2018\"],\"y\":[1213.7,1207.7],\"text\":[\"Value:  1213.7\",\"Value:  1207.7\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Government Funding\",\"marker\":{\"color\":\"rgba(231,138,195,1)\",\"line\":{\"color\":\"rgba(231,138,195,1)\"}},\"textfont\":{\"color\":\"rgba(231,138,195,1)\"},\"error_y\":{\"color\":\"rgba(231,138,195,1)\"},\"error_x\":{\"color\":\"rgba(231,138,195,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2018-2019\",\"2017-2018\"],\"y\":[490.10000000000002,573.10000000000002],\"text\":[\"Value:  490.1\",\"Value:  573.1\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Revenue\",\"marker\":{\"color\":\"rgba(166,216,84,1)\",\"line\":{\"color\":\"rgba(166,216,84,1)\"}},\"textfont\":{\"color\":\"rgba(166,216,84,1)\"},\"error_y\":{\"color\":\"rgba(166,216,84,1)\"},\"error_x\":{\"color\":\"rgba(166,216,84,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2018-2019\",\"2017-2018\"],\"y\":[124.40000000000001,127.2],\"text\":[\"Value:  124.4\",\"Value:  127.2\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Subscriber fee\",\"marker\":{\"color\":\"rgba(255,217,47,1)\",\"line\":{\"color\":\"rgba(255,217,47,1)\"}},\"textfont\":{\"color\":\"rgba(255,217,47,1)\"},\"error_y\":{\"color\":\"rgba(255,217,47,1)\"},\"error_x\":{\"color\":\"rgba(255,217,47,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[\"2018-2019\",\"2017-2018\"],\"y\":[217.80000000000001,275.69999999999999],\"text\":[\"Value:  217.8\",\"Value:  275.7\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"bar\",\"name\":\"Television\",\"marker\":{\"color\":\"rgba(229,196,148,1)\",\"line\":{\"color\":\"rgba(229,196,148,1)\"}},\"textfont\":{\"color\":\"rgba(229,196,148,1)\"},\"error_y\":{\"color\":\"rgba(229,196,148,1)\"},\"error_x\":{\"color\":\"rgba(229,196,148,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(plotly)\n\n# Sample data\ndf <- data.frame(\n  Year = c(\"2018-2019\", \"2017-2018\"),\n  Government_Funding = c(1213.7, 1207.7),\n  Financing_and_other_income = c(116.9, 127.6),\n  Subscription_fee = c(124.4, 127.2),\n  Digital = c(31.0, 42.6),\n  Television = c(217.8, 275.7)\n)\n\n# Reshape the data using pivot_longer\ndf_long <- df %>%\n  pivot_longer(cols = -Year, names_to = \"Category\", values_to = \"Value\") \n\n# Plotting using ggplot\np <- ggplot(df_long, aes(x = Category, y = Value, color = Year, group = Year)) +\n  geom_line() +\n  geom_point() +\n  labs(title = \"Funding and Revenue Comparison\",\n       y = \"Value\",\n       x = \"Category\") +\n  theme_minimal()+\n       theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n# Convert ggplot object to plotly\nplotly_plot <- ggplotly(p, tooltip = c(\"x\", \"y\")) \n\n# Show the interactive plot\nplotly_plot\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-2118aa6db73d5d87dc5e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-2118aa6db73d5d87dc5e\">{\"x\":{\"data\":[{\"x\":[1,2,3,4,5],\"y\":[42.600000000000001,127.59999999999999,1207.7,127.2,275.69999999999999],\"text\":[\"Category: Digital<br />Value:   42.6\",\"Category: Financing_and_other_income<br />Value:  127.6\",\"Category: Government_Funding<br />Value: 1207.7\",\"Category: Subscription_fee<br />Value:  127.2\",\"Category: Television<br />Value:  275.7\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2017-2018\",\"legendgroup\":\"2017-2018\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1,2,3,4,5],\"y\":[31,116.90000000000001,1213.7,124.40000000000001,217.80000000000001],\"text\":[\"Category: Digital<br />Value:   31.0\",\"Category: Financing_and_other_income<br />Value:  116.9\",\"Category: Government_Funding<br />Value: 1213.7\",\"Category: Subscription_fee<br />Value:  124.4\",\"Category: Television<br />Value:  217.8\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,191,196,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"name\":\"2018-2019\",\"legendgroup\":\"2018-2019\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[3,2,4,1,5],\"y\":[1207.7,127.59999999999999,127.2,42.600000000000001,275.69999999999999],\"text\":[\"Category: Government_Funding<br />Value: 1207.7\",\"Category: Financing_and_other_income<br />Value:  127.6\",\"Category: Subscription_fee<br />Value:  127.2\",\"Category: Digital<br />Value:   42.6\",\"Category: Television<br />Value:  275.7\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(248,118,109,1)\"}},\"hoveron\":\"points\",\"name\":\"2017-2018\",\"legendgroup\":\"2017-2018\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[3,2,4,1,5],\"y\":[1213.7,116.90000000000001,124.40000000000001,31,217.80000000000001],\"text\":[\"Category: Government_Funding<br />Value: 1213.7\",\"Category: Financing_and_other_income<br />Value:  116.9\",\"Category: Subscription_fee<br />Value:  124.4\",\"Category: Digital<br />Value:   31.0\",\"Category: Television<br />Value:  217.8\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"opacity\":1,\"size\":5.6692913385826778,\"symbol\":\"circle\",\"line\":{\"width\":1.8897637795275593,\"color\":\"rgba(0,191,196,1)\"}},\"hoveron\":\"points\",\"name\":\"2018-2019\",\"legendgroup\":\"2018-2019\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":43.762557077625573,\"r\":7.3059360730593621,\"b\":108.55873748763783,\"l\":48.949771689497723},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Funding and Revenue Comparison\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":17.534246575342465},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,5.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Digital\",\"Financing_and_other_income\",\"Government_Funding\",\"Subscription_fee\",\"Television\"],\"tickvals\":[1,2,3,4,5],\"categoryorder\":\"array\",\"categoryarray\":[\"Digital\",\"Financing_and_other_income\",\"Government_Funding\",\"Subscription_fee\",\"Television\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Category\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-28.135000000000005,1272.835],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"250\",\"500\",\"750\",\"1000\",\"1250\"],\"tickvals\":[0,250,500,750,1000,1250],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"250\",\"500\",\"750\",\"1000\",\"1250\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Value\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Year\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"4df4372e5054\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"},\"4df44e905884\":{\"x\":{},\"y\":{},\"colour\":{}}},\"cur_data\":\"4df4372e5054\",\"visdat\":{\"4df4372e5054\":[\"function (y) \",\"x\"],\"4df44e905884\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(shiny)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'shiny' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\n# Sample data\ndf <- data.frame(\n  Year = c(\"2018-2019\", \"2017-2018\"),\n  Government_Funding = c(1213.7, 1207.7),\n  Financing_and_other_income = c(116.9, 127.6),\n  Subscription_fee = c(124.4, 127.2),\n  Digital = c(31.0, 42.6),\n  Television = c(217.8, 275.7)\n)\n\n# Reshape the data using pivot_longer\ndf_long <- df %>%\n  pivot_longer(cols = -Year, names_to = \"Category\", values_to = \"Value\") \n\n# UI for Shiny app\nui <- fluidPage(\n  titlePanel(\"Funding and Revenue Comparison\"),\n  sidebarLayout(\n    sidebarPanel(\n      selectInput(\"year\", \"Select Year:\", choices = unique(df$Year))\n    ),\n    mainPanel(\n      plotlyOutput(\"plot\")\n    )\n  )\n)\n\n# Server logic for Shiny app\nserver <- function(input, output) {\n  filtered_data <- reactive({\n    df_long %>%\n      filter(Year == input$year)\n  })\n  \n  output$plot <- renderPlotly({\n    p <- ggplot(filtered_data(), aes(x = Category, y = Value, color = Year, group = Year)) +\n      geom_line() +\n      geom_point() +\n      labs(title = paste(\"Funding and Revenue Comparison for\", input$year),\n           y = \"Value\",\n           x = \"Category\") +\n      theme_minimal()+\n       theme(axis.text.x = element_text(angle = 45, hjust = 1))\n    \n    ggplotly(p, tooltip = c(\"x\", \"y\")) \n  })\n}\n\n# Run the Shiny app\nshinyApp(ui = ui, server = server)\n```\n\n::: {.cell-output-display}\n`<div style=\"width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;\" class=\"muted well\">Shiny applications not supported in static R Markdown documents</div>`{=html}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(plotly)\nlibrary(shiny)\n\n# Sample data\ndf <- data.frame(\n  Year = c(\"2018-2019\", \"2017-2018\")\n  ,\n  Government_Funding = c(1213.7, 1207.7),\n  Financing_and_other_income = c(116.9, 127.6),\n  Subscription_fee = c(124.4, 127.2),\n  Digital = c(31.0, 42.6),\n  Television = c(217.8, 275.7)\n)\n\n# Reshape the data using pivot_longer\ndf_long <- df %>%\n  pivot_longer(cols = -Year, names_to = \"Category\", values_to = \"Value\") \n\n# UI for Shiny app\nui <- fluidPage(\n  titlePanel(\"Funding and Revenue Comparison\"),\n  sidebarLayout(\n    sidebarPanel(\n      selectInput(\"year\", \"Select Year:\", choices = unique(df$Year)),\n      selectInput(\"revenue\", \"Select Revenue Components:\", \n                  choices = c(\"Financing_and_other_income\", \n                              \"Subscription_fee\", \n                              \"Digital\", \n                              \"Television\"))\n    ),\n    mainPanel(\n      plotlyOutput(\"plot\")\n    )\n  )\n)\n\n# Server logic for Shiny app\nserver <- function(input, output) {\n  filtered_data <- reactive({\n    df_long %>%\n      filter(Year == input$year)\n  })\n  \n  revenue_data <- reactive({\n    df_long %>%\n      filter(Year == input$year & Category == input$revenue)\n  })\n  \n  output$plot <- renderPlotly({\n    p <- ggplot(filtered_data(), aes(x = Category, y = Value, color = Year, group = Year)) +\n      geom_line() +\n      geom_point() +\n      geom_line(data = revenue_data(), aes(group = NULL), color = \"black\", size = 1.5) +\n      geom_point(data = revenue_data(), color = \"black\", size = 3) +\n      labs(title = paste(\"Funding and Revenue Comparison for\", input$year),\n           y = \"Value\",\n           x = \"Category\") +\n      theme_minimal() +\n      theme(axis.text.x = element_text(angle = 45, hjust = 1))\n    \n    ggplotly(p, tooltip = c(\"x\", \"y\")) \n  })\n}\n\n# Run the Shiny app\nshinyApp(ui = ui, server = server)\n```\n\n::: {.cell-output-display}\n`<div style=\"width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;\" class=\"muted well\">Shiny applications not supported in static R Markdown documents</div>`{=html}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nserver <- function(input, output) {\n  filtered_data <- reactive({\n    df_long %>%\n      filter(Year == input$year)\n  })\n  \n  revenue_data <- reactive({\n    if (!is.null(input$type) && input$type == \"Revenue\") {\n      df_long %>%\n        filter(Category != \"Government_Funding\", Year == input$year)\n    } \n    else if (!is.null(input$type) && input$type == \"Advertising\") {\n      df_long %>%\n        filter(Category %in% c(\"Digital\",\"Television\"), Year == input$year)\n    }\n  })\n  \n  output$plot <- renderPlotly({\n    p <- ggplot(filtered_data(), aes(x = Category, y = Value, color = Year, group = Year)) +\n      geom_line() +\n      geom_point() +\n      geom_point(data = revenue_data(), color = \"black\", size = 3) +\n      labs(title = paste(\"Funding and Revenue Comparison for\", input$year),\n           y = \"Value\",\n           x = \"Category\") +\n      theme_minimal() +\n      theme(axis.text.x = element_text(angle = 45, hjust = 1))\n    \n    if (!is.null(input$type)) {\n      if (input$type == \"Revenue\") {\n        p <- p + geom_line(data = revenue_data(), aes(group = Year), color = \"black\", size = 1.5)\n      } else if (input$type == \"Advertising\") {\n        p <- p + geom_line(data = revenue_data(), aes(group = Year), color = \"black\", size = 1)\n      }\n    }\n    \n    ggplotly(p, tooltip = c(\"x\", \"y\")) \n  })\n}\n\n# Run the Shiny app\nshinyApp(ui = ui, server = server)\n```\n\n::: {.cell-output-display}\n`<div style=\"width: 100% ; height: 400px ; text-align: center; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box;\" class=\"muted well\">Shiny applications not supported in static R Markdown documents</div>`{=html}\n:::\n:::\n\n\n## Including Plots\n\nYou can also embed plots, for example:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](mid_files/figure-html/pressure-1.png){width=672}\n:::\n:::\n\n\nNote that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.\n",
    "supporting": [
      "mid_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<script src=\"site_libs/plotly-binding-4.10.4/plotly.js\"></script>\r\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\r\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}